<div class="spacer"></div>
<h1 *ngIf="isAddMode" class="p-4">Add Recipe</h1>
<h1 *ngIf="!isAddMode" class="p-4">Edit Recipe</h1>

<!-- main recipe fields -->
<div class="p-4">
  <form [formGroup]="form" (ngSubmit)="onSubmit()">
    <div class="form-group row p-2">
      <label class="col-sm-3 col-form-label">Name</label>
      <div class="col-sm-9">
        <input
          [formControlName]="'name'"
          id="name"
          class="form-control"
          [ngClass]="{ 'is-invalid': submitted && f.name.errors }" />

        <div *ngIf="submitted && f.name.errors" class="invalid-feedback">
          <div *ngIf="f.name.errors.required">Name is required</div>
        </div>
      </div>
    </div>

    <div class="form-group row p-2">
      <label class="col-sm-3 col-form-label">Status</label>
      <div class="col-sm-9">
        <input
          [formControlName]="'status'"
          id="status"
          class="form-control"
          [ngClass]="{ 'is-invalid': submitted && f.status.errors }" />
        <div *ngIf="submitted && f.status.errors" class="invalid-feedback">
          <div *ngIf="f.status.errors.required">Status is required</div>
        </div>
      </div>
    </div>

    <div class="form-group row p-2">
      <label class="col-sm-3 col-form-label">Batch ID</label>
      <div class="col-sm-9">
        <input
          [formControlName]="'batchId'"
          id="batchId"
          class="form-control"
          [ngClass]="{ 'is-invalid': submitted && f.batchId.errors }" />
        <div *ngIf="submitted && f.batchId.errors" class="invalid-feedback">
          <div *ngIf="f.batchId.errors.required">Batch Number is required</div>
        </div>
      </div>
    </div>

    <div class="form-group row p-2">
      <label class="col-sm-3 col-form-label">Previous Batch ID</label>
      <div class="col-sm-9">
        <input
          [formControlName]="'previousBatchId'"
          id="previousBatchId"
          class="form-control"
          [ngClass]="{ 'is-invalid': submitted && f.previousBatchId.errors }" />
        <div *ngIf="submitted && f.previousBatchId.errors" class="invalid-feedback">
          <div *ngIf="f.previousBatchId.errors.required">Previous Batch Number is required</div>
        </div>
      </div>
    </div>

    <div class="form-group row p-2">
      <label class="col-sm-3 col-form-label">Date</label>
      <div class="col-sm-9">
        <input
          [formControlName]="'date'"
          id="date"
          class="form-control"
          [ngClass]="{ 'is-invalid': submitted && f.date.errors }" />
        <div *ngIf="submitted && f.date.errors" class="invalid-feedback">
          <div *ngIf="f.date.errors.required">Date is required</div>
        </div>
      </div>
    </div>

    <div class="form-group row p-2">
      <label class="col-sm-3 col-form-label">Type</label>
      <div class="col-sm-9">
        <input
          [formControlName]="'type'"
          id="type"
          class="form-control"
          [ngClass]="{ 'is-invalid': submitted && f.type.errors }" />
        <div *ngIf="submitted && f.type.errors" class="invalid-feedback">
          <div *ngIf="f.type.errors.required">Type is required</div>
        </div>
      </div>
    </div>

    <div class="form-group row p-2">
      <label class="col-sm-3 col-form-label">Batch Yield</label>
      <div class="col-sm-9">
        <input
          [formControlName]="'batchYield'"
          id="batchYield"
          class="form-control"
          [ngClass]="{ 'is-invalid': submitted && f.batchYield.errors }" />
        <div *ngIf="submitted && f.batchYield.errors" class="invalid-feedback">
          <div *ngIf="f.batchYield.errors.required">Batch Yield is required</div>
        </div>
      </div>
    </div>

    <div class="form-group row p-2">
      <label class="col-sm-3 col-form-label">Target Color</label>
      <div class="col-sm-9">
        <input
          [formControlName]="'targetColor'"
          id="targetColor"
          class="form-control"
          [ngClass]="{ 'is-invalid': submitted && f.targetColor.errors }" />
        <div *ngIf="submitted && f.targetColor.errors" class="invalid-feedback">
          <div *ngIf="f.targetColor.errors.required">Target Color is required</div>
        </div>
      </div>
    </div>

    <div class="form-group row p-2">
      <label class="col-sm-3 col-form-label">Yeast Vessel</label>
      <div class="col-sm-9">
        <input
          [formControlName]="'yeastVessel'"
          id="yeastVessel"
          class="form-control" />
      </div>
    </div>

    <div class="form-group row p-2">
      <label class="col-sm-3 col-form-label">Fermentor Vessel</label>
      <div class="col-sm-9">
        <input
          [formControlName]="'fermentorVessel'"
          id="fermentorVessel"
          class="form-control" />
      </div>
    </div>

    <div class="form-group row p-2">
      <label class="col-sm-3 col-form-label">Pitch Volume</label>
      <div class="col-sm-9">
        <input
          [formControlName]="'pitchVolume'"
          id="pitchVolume"
          class="form-control"
          [ngClass]="{ 'is-invalid': submitted && f.pitchVolume.errors }" />
        <div *ngIf="submitted && f.pitchVolume.errors" class="invalid-feedback">
          <div *ngIf="f.pitchVolume.errors.required">Pitch Volume is required</div>
        </div>
      </div>
    </div>

    <div class="form-group row p-2">
      <label class="col-sm-3 col-form-label">Description</label>
      <div class="col-sm-9">
        <input
          [formControlName]="'description'"
          id="description"
          class="form-control"
          [ngClass]="{ 'is-invalid': submitted && f.description.errors }" />
        <div *ngIf="submitted && f.description.errors" class="invalid-feedback">
          <div *ngIf="f.description.errors.required">Description is required</div>
        </div>
      </div>
    </div>

    <!-- calculated fields -->
    <div class="form-group row p-2">
      <label class="col-sm-3 col-form-label">Target Original Gravity</label>
      <div class="col-sm-9">
        <input
          [formControlName]="'targetOG'"
          id="targetOG"
          class="form-control"
          [ngClass]="{ 'is-invalid': submitted && f.targetOG.errors }" />
        <div *ngIf="submitted && f.targetOG.errors" class="invalid-feedback">
          <div *ngIf="f.targetOG.errors.required">Target Original Gravity is required</div>
        </div>
      </div>
    </div>


    <div class="form-group row p-2">
      <label class="col-sm-3 col-form-label">Target Efficiency</label>
      <div class="col-sm-9">
        <input
          [formControlName]="'targetEff'"
          id="targetEff"
          class="form-control"
          [ngClass]="{ 'is-invalid': submitted && f.targetEff.errors }" />
        <div *ngIf="submitted && f.targetEff.errors" class="invalid-feedback">
          <div *ngIf="f.targetEff.errors.required">Target Efficiency is required</div>
        </div>
      </div>
    </div>

    <div class="form-group row p-2">
      <label class="col-sm-3 col-form-label">Target IBUs</label>
      <div class="col-sm-9">
        <input
          [formControlName]="'targetIbus'"
          id="targetIbus"
          class="form-control"
          [ngClass]="{ 'is-invalid': submitted && f.targetIbus.errors }" />
        <div *ngIf="submitted && f.targetIbus.errors" class="invalid-feedback">
          <div *ngIf="f.targetIbus.errors.required">Target IBUs are required</div>
        </div>
      </div>
    </div>


    <!-- associated records -->
    <p>
    <div class="container border border-primary p-2">

      <p>
        <button type="button" class="btn btn-outline-primary" (click)="isShowGrain = !isShowGrain"
          [attr.aria-expanded]="!isShowGrain" aria-controls="collapseExample">
          <div *ngIf="isShowGrain">
            <h5>Grains
              <i class="fa fa-solid fa-angle-up"></i>
            </h5>
          </div>
          <div *ngIf="!isShowGrain">
            <h5>Grains
              <i class="fa fa-solid fa-angle-down"></i>
            </h5>
          </div>
        </button>
      </p>
      <div id="collapseExample" [ngbCollapse]="!isShowGrain">
        <div class="card">
          <div class="card-body">
            <recipe-grain [recipeGrains]="r.recipeGrains" [id]="r.id"></recipe-grain>
          </div>
        </div>
      </div>

    </div>

    <p>
    <div class="container border border-primary p-2">

      <p>
        <button type="button" class="btn btn-outline-primary" (click)="isShowHop = !isShowHop"
          [attr.aria-expanded]="!isShowHop" aria-controls="collapseExample">
          <div *ngIf="isShowHop">
            <h5>Hops
              <i class="fa fa-solid fa-angle-up"></i>
            </h5>
          </div>
          <div *ngIf="!isShowHop">
            <h5>Hops
              <i class="fa fa-solid fa-angle-down"></i>
            </h5>
          </div>
        </button>
      </p>
      <div id="collapseExample" [ngbCollapse]="!isShowHop">
        <div class="card">
          <div class="card-body">
            <recipe-hop [recipeHops]="r.recipeHops" [id]="r.id"></recipe-hop>
          </div>
        </div>
      </div>

    </div>


    <p>
    <div class="container border border-primary p-2">

      <p>
        <button type="button" class="btn btn-outline-primary" (click)="isShowBrewer = !isShowBrewer"
          [attr.aria-expanded]="!isShowBrewer" aria-controls="collapseExample">
          <div *ngIf="isShowBrewer">
            <h5>Brewers
              <i class="fa fa-solid fa-angle-up"></i>
            </h5>
          </div>
          <div *ngIf="!isShowBrewer">
            <h5>Brewers
              <i class="fa fa-solid fa-angle-down"></i>
            </h5>
          </div>
        </button>
      </p>
      <div id="collapseExample" [ngbCollapse]="!isShowBrewer">
        <div class="card">
          <div class="card-body">
            <recipe-brewer [recipeBrewers]="r.recipeBrewers" [id]="r.id"></recipe-brewer>
          </div>
        </div>
      </div>

    </div>



    <div class="btn-toolbar p-4">
      <button *ngIf="isAddMode" type="submit" class="btn btn-primary">Add</button>
      <button *ngIf="!isAddMode" type="submit" class="btn btn-primary">Update</button>
    </div>

  </form>


</div>